# S03 – eda_cli: мини-EDA для CSV

Небольшое CLI-приложение для базового анализа CSV-файлов.
Используется в рамках Семинара 03 курса «Инженерия ИИ».

## Требования

- Python 3.11+
- [uv](https://docs.astral.sh/uv/) установлен в систему

## Инициализация проекта

В корне проекта (S03):

```bash
uv sync
```

Эта команда:

- создаст виртуальное окружение `.venv`;
- установит зависимости из `pyproject.toml`;
- установит сам проект `eda-cli` в окружение.

## Доступные команды CLI

### 1. Краткий обзор (overview)

```bash
uv run eda-cli overview data/example.csv
```

Параметры:

- `--sep` – разделитель (по умолчанию `,`);
- `--encoding` – кодировка (по умолчанию `utf-8`).

Выводит краткую статистику по датасету: количество строк/столбцов и таблицу с характеристиками каждой колонки.

### 2. Полный EDA-отчёт (report)

```bash
uv run eda-cli report data/example.csv --out-dir reports
```

**Новые параметры, добавленные к команде report:**

- `--title` – заголовок отчёта (по умолчанию: "Какой-то интересный отчётик про EDA CSV файла, приятного")
- `--top-k-categories` – количество топовых категорий для вывода по категориальным признакам (по умолчанию: 2)

**Как новые параметры влияют на отчёт:**
- `--title` задаёт пользовательский заголовок в Markdown-отчёте
- `--top-k-categories` определяет, сколько самых частых значений показывать для категориальных колонок

**Новые флаги качества данных в отчёте:**
- `has_high_cardinality_categoricals` – показывает, есть ли колонки с высокой кардинальностью (более 10 уникальных значений в более чем 6 колонках)
- `has_suspicious_id_duplicates` – проверяет, содержит ли первая колонка (предположительно user_id) все уникальные значения

**Обновлённый расчёт скор-оценки качества:**
- Базовая оценка: 1.0
- Уменьшается на долю максимальных пропусков
- Дополнительно снижается на 0.5 при наличии подозрительных дубликатов в ID
- Дополнительные штрафы за мало строк (<100) или много колонок (>100)
- Ограничена диапазоном [0.0, 1.0]

## Примеры вызова с новыми опциями

```bash
# С пользовательским заголовком и 5 топовыми категориями
uv run eda-cli report data/example.csv \
  --out-dir reports_example \
  --title "Анализ пользовательских данных" \
  --top-k-categories 5

# С параметрами по умолчанию
uv run eda-cli report data/S02-hw-dataset.csv --out-dir reports
```

## Выходные файлы отчёта

В указанном каталоге (`--out-dir`) создаются:

- `report.md` – основной отчёт в Markdown с новыми флагами качества
- `summary.csv` – таблица со статистикой по колонкам
- `missing.csv` – пропуски по колонкам
- `correlation.csv` – корреляционная матрица (если есть числовые признаки)
- `top_categories/*.csv` – top-k категорий по строковым признакам
- `hist_*.png` – гистограммы числовых колонок
- `missing_matrix.png` – визуализация пропусков
- `correlation_heatmap.png` – тепловая карта корреляций

## Тесты

```bash
uv run pytest -q
```